
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://poets-ai.github.io/elegy/api/ModelBase/">
      
      <link rel="shortcut icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.7">
    
    
      
        <title>ModelBase - Elegy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#elegymodelbase" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://poets-ai.github.io/elegy" title="Elegy" class="md-header-nav__button md-logo" aria-label="Elegy">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M471.1 96C405 96 353.3 137.3 320 174.6 286.7 137.3 235 96 168.9 96 75.8 96 0 167.8 0 256s75.8 160 168.9 160c66.1 0 117.8-41.3 151.1-78.6 33.3 37.3 85 78.6 151.1 78.6 93.1 0 168.9-71.8 168.9-160S564.2 96 471.1 96zM168.9 320c-40.2 0-72.9-28.7-72.9-64s32.7-64 72.9-64c38.2 0 73.4 36.1 94 64-20.4 27.6-55.9 64-94 64zm302.2 0c-38.2 0-73.4-36.1-94-64 20.4-27.6 55.9-64 94-64 40.2 0 72.9 28.7 72.9 64s-32.7 64-72.9 64z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Elegy
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              ModelBase
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/poets-ai/elegy/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
  </div>
  <div class="md-source__repository">
    poets-ai/elegy
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://poets-ai.github.io/elegy" title="Elegy" class="md-nav__button md-logo" aria-label="Elegy">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M471.1 96C405 96 353.3 137.3 320 174.6 286.7 137.3 235 96 168.9 96 75.8 96 0 167.8 0 256s75.8 160 168.9 160c66.1 0 117.8-41.3 151.1-78.6 33.3 37.3 85 78.6 151.1 78.6 93.1 0 168.9-71.8 168.9-160S564.2 96 471.1 96zM168.9 320c-40.2 0-72.9-28.7-72.9-64s32.7-64 72.9-64c38.2 0 73.4 36.1 94 64-20.4 27.6-55.9 64-94 64zm302.2 0c-38.2 0-73.4-36.1-94-64 20.4-27.6 55.9-64 94-64 40.2 0 72.9 28.7 72.9 64s-32.7 64-72.9 64z"/></svg>

    </a>
    Elegy
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/poets-ai/elegy/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
  </div>
  <div class="md-source__repository">
    poets-ai/elegy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        Getting Started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started-high-level-api/" class="md-nav__link">
        High Level API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started-low-level-api/" class="md-nav__link">
        Low Level API
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        High Level API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="High Level API" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          High Level API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../basic-api/modules-losses-metrics/" class="md-nav__link">
        Intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Data Sources
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3" >
      
      <label class="md-nav__link" for="nav-3-3">
        Module
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Module" data-md-level="2">
        <label class="md-nav__title" for="nav-3-3">
          <span class="md-nav__icon md-icon"></span>
          Module
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Flax
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Haiku
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Elegy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Pure Jax
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Supporting Other Modules
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Losses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Metrics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Dependency Injection
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Hooks
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8" >
      
      <label class="md-nav__link" for="nav-3-8">
        Optimizer
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Optimizer" data-md-level="2">
        <label class="md-nav__title" for="nav-3-8">
          <span class="md-nav__icon md-icon"></span>
          Optimizer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Optax Optimizer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Elegy Optimizer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Monitoring Learning Rate
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Supporting Other Optimizers
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Callbacks
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Serialization
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Low Level API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Low Level API" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Low Level API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Intro
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Custom pred_step
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Custom test_step
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Custom grad_step
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Custom train_step
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../low-level-api/supporting-the-high-level-api/" class="md-nav__link">
        Supporting the High Level API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../na/" class="md-nav__link">
        Implementing a Model from Scratch
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../module-system.md" class="md-nav__link">
        Elegy Module
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
      
      <label class="md-nav__link" for="nav-7">
        API Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="nav-7">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../GeneralizedModule/" class="md-nav__link">
        GeneralizedModule
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../GeneralizedOptimizer/" class="md-nav__link">
        GeneralizedOptimizer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../GradStep/" class="md-nav__link">
        GradStep
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../HaikuModule/" class="md-nav__link">
        HaikuModule
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Loss/" class="md-nav__link">
        Loss
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Losses/" class="md-nav__link">
        Losses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Metric/" class="md-nav__link">
        Metric
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Metrics/" class="md-nav__link">
        Metrics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Model/" class="md-nav__link">
        Model
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          ModelBase
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        ModelBase
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase" class="md-nav__link">
    elegy.model.model_base.ModelBase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.evaluate" class="md-nav__link">
    evaluate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.load" class="md-nav__link">
    load()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.predict_on_batch" class="md-nav__link">
    predict_on_batch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.save" class="md-nav__link">
    save()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.test_on_batch" class="md-nav__link">
    test_on_batch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.train_on_batch" class="md-nav__link">
    train_on_batch()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Module/" class="md-nav__link">
        Module
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Optimizer/" class="md-nav__link">
        Optimizer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../OutputStates/" class="md-nav__link">
        OutputStates
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../PredStep/" class="md-nav__link">
        PredStep
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../RNGSeq/" class="md-nav__link">
        RNGSeq
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../States/" class="md-nav__link">
        States
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../TestStep/" class="md-nav__link">
        TestStep
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../TrainStep/" class="md-nav__link">
        TrainStep
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Uninitialized/" class="md-nav__link">
        Uninitialized
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-20" type="checkbox" id="nav-7-20" >
      
      <label class="md-nav__link" for="nav-7-20">
        callbacks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="callbacks" data-md-level="2">
        <label class="md-nav__title" for="nav-7-20">
          <span class="md-nav__icon md-icon"></span>
          callbacks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/CSVLogger/" class="md-nav__link">
        CSVLogger
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/Callback/" class="md-nav__link">
        Callback
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/CallbackList/" class="md-nav__link">
        CallbackList
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/EarlyStopping/" class="md-nav__link">
        EarlyStopping
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/History/" class="md-nav__link">
        History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/LambdaCallback/" class="md-nav__link">
        LambdaCallback
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/ModelCheckpoint/" class="md-nav__link">
        ModelCheckpoint
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/RemoteMonitor/" class="md-nav__link">
        RemoteMonitor
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/TensorBoard/" class="md-nav__link">
        TensorBoard
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../callbacks/TerminateOnNaN/" class="md-nav__link">
        TerminateOnNaN
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../flax_summarize/" class="md-nav__link">
        flax_summarize
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../flax_summary/" class="md-nav__link">
        flax_summary
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-23" type="checkbox" id="nav-7-23" >
      
      <label class="md-nav__link" for="nav-7-23">
        hooks
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="hooks" data-md-level="2">
        <label class="md-nav__title" for="nav-7-23">
          <span class="md-nav__icon md-icon"></span>
          hooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/add_loss/" class="md-nav__link">
        add_loss
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/add_metric/" class="md-nav__link">
        add_metric
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/add_summary/" class="md-nav__link">
        add_summary
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/context/" class="md-nav__link">
        context
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/get_losses/" class="md-nav__link">
        get_losses
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/get_metrics/" class="md-nav__link">
        get_metrics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/get_summaries/" class="md-nav__link">
        get_summaries
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/jit/" class="md-nav__link">
        jit
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/losses_active/" class="md-nav__link">
        losses_active
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/metrics_active/" class="md-nav__link">
        metrics_active
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hooks/summaries_active/" class="md-nav__link">
        summaries_active
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-24" type="checkbox" id="nav-7-24" >
      
      <label class="md-nav__link" for="nav-7-24">
        initializers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="initializers" data-md-level="2">
        <label class="md-nav__title" for="nav-7-24">
          <span class="md-nav__icon md-icon"></span>
          initializers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/Constant/" class="md-nav__link">
        Constant
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/Orthogonal/" class="md-nav__link">
        Orthogonal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/RandomNormal/" class="md-nav__link">
        RandomNormal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/RandomUniform/" class="md-nav__link">
        RandomUniform
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/TruncatedNormal/" class="md-nav__link">
        TruncatedNormal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/UniformScaling/" class="md-nav__link">
        UniformScaling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../initializers/VarianceScaling/" class="md-nav__link">
        VarianceScaling
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../inject_dependencies/" class="md-nav__link">
        inject_dependencies
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-26" type="checkbox" id="nav-7-26" >
      
      <label class="md-nav__link" for="nav-7-26">
        losses
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="losses" data-md-level="2">
        <label class="md-nav__title" for="nav-7-26">
          <span class="md-nav__icon md-icon"></span>
          losses
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/BinaryCrossentropy/" class="md-nav__link">
        BinaryCrossentropy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/CategoricalCrossentropy/" class="md-nav__link">
        CategoricalCrossentropy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/CosineSimilarity/" class="md-nav__link">
        CosineSimilarity
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/Huber/" class="md-nav__link">
        Huber
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/Loss/" class="md-nav__link">
        Loss
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/MeanAbsoluteError/" class="md-nav__link">
        MeanAbsoluteError
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/MeanAbsolutePercentageError/" class="md-nav__link">
        MeanAbsolutePercentageError
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/MeanSquaredError/" class="md-nav__link">
        MeanSquaredError
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/MeanSquaredLogarithmicError/" class="md-nav__link">
        MeanSquaredLogarithmicError
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/Reduction/" class="md-nav__link">
        Reduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/SparseCategoricalCrossentropy/" class="md-nav__link">
        SparseCategoricalCrossentropy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/binary_crossentropy/" class="md-nav__link">
        binary_crossentropy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/cosine_similarity/" class="md-nav__link">
        cosine_similarity
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/huber/" class="md-nav__link">
        huber
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/mean_absolute_error/" class="md-nav__link">
        mean_absolute_error
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/mean_absolute_percentage_error/" class="md-nav__link">
        mean_absolute_percentage_error
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/mean_squared_error/" class="md-nav__link">
        mean_squared_error
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/mean_squared_logarithmic_error/" class="md-nav__link">
        mean_squared_logarithmic_error
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../losses/sparse_categorical_crossentropy/" class="md-nav__link">
        sparse_categorical_crossentropy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-27" type="checkbox" id="nav-7-27" >
      
      <label class="md-nav__link" for="nav-7-27">
        metrics
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="metrics" data-md-level="2">
        <label class="md-nav__title" for="nav-7-27">
          <span class="md-nav__icon md-icon"></span>
          metrics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/Accuracy/" class="md-nav__link">
        Accuracy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/BinaryAccuracy/" class="md-nav__link">
        BinaryAccuracy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/BinaryCrossentropy/" class="md-nav__link">
        BinaryCrossentropy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/CategoricalAccuracy/" class="md-nav__link">
        CategoricalAccuracy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/F1/" class="md-nav__link">
        F1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/Mean/" class="md-nav__link">
        Mean
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/MeanAbsoluteError/" class="md-nav__link">
        MeanAbsoluteError
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/MeanAbsolutePercentageError/" class="md-nav__link">
        MeanAbsolutePercentageError
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/MeanSquaredError/" class="md-nav__link">
        MeanSquaredError
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/Metric/" class="md-nav__link">
        Metric
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/Precision/" class="md-nav__link">
        Precision
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/Recall/" class="md-nav__link">
        Recall
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/Reduce/" class="md-nav__link">
        Reduce
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/Reduction/" class="md-nav__link">
        Reduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/SparseCategoricalAccuracy/" class="md-nav__link">
        SparseCategoricalAccuracy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/Sum/" class="md-nav__link">
        Sum
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/accuracy/" class="md-nav__link">
        accuracy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/binary_accuracy/" class="md-nav__link">
        binary_accuracy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/binary_crossentropy/" class="md-nav__link">
        binary_crossentropy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/categorical_accuracy/" class="md-nav__link">
        categorical_accuracy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/f1/" class="md-nav__link">
        f1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/mean_absolute_error/" class="md-nav__link">
        mean_absolute_error
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/mean_absolute_percentage_error/" class="md-nav__link">
        mean_absolute_percentage_error
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/mean_squared_error/" class="md-nav__link">
        mean_squared_error
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/precision/" class="md-nav__link">
        precision
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/recall/" class="md-nav__link">
        recall
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/reduce/" class="md-nav__link">
        reduce
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/sparse_categorical_accuracy/" class="md-nav__link">
        sparse_categorical_accuracy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-28" type="checkbox" id="nav-7-28" >
      
      <label class="md-nav__link" for="nav-7-28">
        nets
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="nets" data-md-level="2">
        <label class="md-nav__title" for="nav-7-28">
          <span class="md-nav__icon md-icon"></span>
          nets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nets/ResNet/" class="md-nav__link">
        ResNet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nets/ResNet101/" class="md-nav__link">
        ResNet101
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nets/ResNet152/" class="md-nav__link">
        ResNet152
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nets/ResNet18/" class="md-nav__link">
        ResNet18
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nets/ResNet200/" class="md-nav__link">
        ResNet200
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nets/ResNet34/" class="md-nav__link">
        ResNet34
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nets/ResNet50/" class="md-nav__link">
        ResNet50
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-29" type="checkbox" id="nav-7-29" >
      
      <label class="md-nav__link" for="nav-7-29">
        nn
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="nn" data-md-level="2">
        <label class="md-nav__title" for="nav-7-29">
          <span class="md-nav__icon md-icon"></span>
          nn
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/AvgPool/" class="md-nav__link">
        AvgPool
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/BatchNormalization/" class="md-nav__link">
        BatchNormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/Conv1D/" class="md-nav__link">
        Conv1D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/Conv2D/" class="md-nav__link">
        Conv2D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/Conv3D/" class="md-nav__link">
        Conv3D
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/ConvND/" class="md-nav__link">
        ConvND
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/Dropout/" class="md-nav__link">
        Dropout
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/EMAParamsTree/" class="md-nav__link">
        EMAParamsTree
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/EmbedLookupStyle/" class="md-nav__link">
        EmbedLookupStyle
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/Embedding/" class="md-nav__link">
        Embedding
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/Flatten/" class="md-nav__link">
        Flatten
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/InstanceNormalization/" class="md-nav__link">
        InstanceNormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/LayerNormalization/" class="md-nav__link">
        LayerNormalization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/Linear/" class="md-nav__link">
        Linear
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/MaxPool/" class="md-nav__link">
        MaxPool
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/Reshape/" class="md-nav__link">
        Reshape
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/Sequential/" class="md-nav__link">
        Sequential
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../nn/sequential/" class="md-nav__link">
        sequential
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-30" type="checkbox" id="nav-7-30" >
      
      <label class="md-nav__link" for="nav-7-30">
        regularizers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="regularizers" data-md-level="2">
        <label class="md-nav__title" for="nav-7-30">
          <span class="md-nav__icon md-icon"></span>
          regularizers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../regularizers/GlobalL1/" class="md-nav__link">
        GlobalL1
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../regularizers/GlobalL1L2/" class="md-nav__link">
        GlobalL1L2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../regularizers/GlobalL2/" class="md-nav__link">
        GlobalL2
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../to_module/" class="md-nav__link">
        to_module
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase" class="md-nav__link">
    elegy.model.model_base.ModelBase
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.evaluate" class="md-nav__link">
    evaluate()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.load" class="md-nav__link">
    load()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.predict_on_batch" class="md-nav__link">
    predict_on_batch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.save" class="md-nav__link">
    save()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.test_on_batch" class="md-nav__link">
    test_on_batch()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elegy.model.model_base.ModelBase.train_on_batch" class="md-nav__link">
    train_on_batch()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/poets-ai/elegy/edit/master/docs/api/ModelBase.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="elegymodelbase">elegy.ModelBase</h1>
<div class="doc doc-object doc-class">
<h2 class="hidden-toc" id="elegy.model.model_base.ModelBase" style="visibility: hidden; position: absolute;">
        </h2>
<div class="doc doc-contents first">
<p><code>Model</code> is tasked with performing training, evaluation, and inference for a given
<code>elegy.Module</code> or <code>haiku.Module</code>.</p>
<p>To create a <code>Model</code> you first have to define its architecture in a <code>Module</code>:</p>
<div class="codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">elegy</span><span class="o">,</span> <span class="nn">jax</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">MLP</span><span class="p">(</span><span class="n">elegy</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="o">...</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">elegy</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="o">...</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">elegy</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="o">...</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="o">...</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">elegy</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="o">...</span>         <span class="k">return</span> <span class="n">x</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLP</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">collections</span> <span class="o">=</span> <span class="n">mlp</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">elegy</span><span class="o">.</span><span class="n">RNGSeq</span><span class="p">(</span><span class="mi">42</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></pre>
</div>
<p>You can pass use <code>Module</code> with the Model API:</p>
<div class="codehilite">
<pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">elegy</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
    <span class="n">module</span><span class="o">=</span><span class="n">MLP</span><span class="p">(),</span>
    <span class="n">loss</span><span class="o">=</span><span class="p">[</span>
        <span class="n">elegy</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">elegy</span><span class="o">.</span><span class="n">regularizers</span><span class="o">.</span><span class="n">GlobalL2</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">elegy</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">SparseCategoricalAccuracy</span><span class="p">(),</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optax</span><span class="o">.</span><span class="n">rmsprop</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">),</span>
<span class="p">)</span>
</code></pre>
</div>
<p>Once the model is created, you can train the model with <code>model.fit()</code>, or use the model
to do prediction with <code>model.predict()</code>.
Checkout <a href="https://poets-ai.github.io/elegy/getting-started">Getting Started</a> for
additional details.</p>
<p>Model supports defining + monitoring custom learning rate schedules by passing an instance of <code>elegy.Optimizer</code> instead of
an <code>optax</code> object:</p>
<div class="codehilite">
<pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">elegy</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
    <span class="n">module</span><span class="o">=</span><span class="n">MLP</span><span class="p">(</span><span class="n">n1</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">elegy</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">elegy</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">SparseCategoricalAccuracy</span><span class="p">(),</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">elegy</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">(</span>
        <span class="n">optax</span><span class="o">.</span><span class="n">adam</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="c1"># &lt;---- important to set this to 1.0</span>
        <span class="n">lr_schedule</span><span class="o">=</span><span class="k">lambda</span> <span class="n">step</span><span class="p">,</span> <span class="n">epoch</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">step</span><span class="p">),</span>
        <span class="n">steps_per_epoch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">run_eagerly</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>

<span class="k">assert</span> <span class="s2">"lr"</span> <span class="ow">in</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span>
</code></pre>
</div>
<p>Notice how we set the learning rate parameter of the <code>adam</code> optimizer to <code>1.0</code>, this is necessary if you want the logged <code>lr</code>
be closer to the "actual" learning rate because we implement this feature by chaining an additional <code>optax.scale_by_schedule</code>
at the end.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h2 class="doc doc-heading" id="elegy.model.model_base.ModelBase.evaluate">

<code class="highlight language-python"><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


      </h2>
<div class="doc doc-contents ">
<p>Returns the loss value &amp; metrics values for the model in test mode.
Computation is done in batches.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td><code>Union[numpy.ndarray, Mapping[str, numpy.ndarray], Tuple[numpy.ndarray], Iterable]</code></td>
<td>
<p>Input data. It could be:</p>
<ul>
<li>A Numpy or Jax array (or array-like), or a list of arrays
    (in case the model has multiple inputs).</li>
<li>A dict mapping input names to the corresponding arrays,
    if the model has named inputs.</li>
<li>A generator returning <code>(inputs,)</code>, <code>(inputs, targets)</code>
    or <code>(inputs, targets, sample_weights)</code>.</li>
</ul>
<p>A more detailed description of
unpacking behavior for iterator types generator
is given in the <code>Unpacking behavior for iterator-like inputs</code> section
of <code>Model.fit</code>.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>Union[jax._src.numpy.lax_numpy.ndarray, numpy.ndarray, Mapping[str, numpy.ndarray], Tuple[numpy.ndarray]]</code></td>
<td>
<p>Target data. Like the input data <code>x</code>,
it could be either Numpy or Jax array(s).
It should be consistent with <code>x</code>. If <code>x</code> is a generator,
<code>y</code> should not be specified (since targets will be obtained from <code>x</code>).</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td>
<p>0, 1, or 2. Verbosity mode.
0 = silent, 1 = progress bar, 2 = one line per epoch.</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td><code>Optional[int]</code></td>
<td>
<p>Integer or <code>None</code>.
Number of samples per gradient update.
If unspecified, <code>batch_size</code> will default to 32.
Do not specify the <code>batch_size</code> if your data is in the
form of generator (since they generate batches).</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>sample_weight</code></td>
<td><code>Optional[numpy.ndarray]</code></td>
<td>
<p>Optional Numpy/Jax array of weights for
the training samples, used for weighting the loss function
(during training only). You can either pass a flat (1D)
Numpy array with the same length as the input samples
(1:1 mapping between weights and samples). This argument is not
supported when <code>x</code> is generator, instead provide the sample_weights
as the third element of <code>x</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>steps</code></td>
<td><code>Optional[int]</code></td>
<td>
<p>Integer or <code>None</code>. Total number of steps (batches of samples)
before declaring the evaluation round finished. Ignored with the
default value of <code>None</code>. This
argument is not supported with array inputs.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Union[List[elegy.callbacks.callback.Callback], elegy.callbacks.callback_list.CallbackList]</code></td>
<td>
<p>List of <a href="../callbacks/Callback/#elegy.callbacks.callback.Callback">elegy.callbacks.callback.Callback</a> instances.
List of callbacks to apply during training.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p>See the discussion of <code>Unpacking behavior for iterator-like inputs</code> for
<a href="../Model/#elegy.model.model.Model.fit"><code>Model.fit</code></a>.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Dict[str, Union[numpy.ndarray, float]]</code></td>
<td>
<p>A dictionary for mapping the losses and metrics names to the values obtained.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>in case of invalid arguments.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>elegy/model/model_base.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Iterable</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="kc">None</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">tp</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Callback</span><span class="p">],</span> <span class="n">CallbackList</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">types</span><span class="o">.</span><span class="n">Logs</span><span class="p">:</span>
    <span class="sd">"""Returns the loss value &amp; metrics values for the model in test mode.</span>
<span class="sd">    Computation is done in batches.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        x: Input data. It could be:</span>

<span class="sd">            - A Numpy or Jax array (or array-like), or a list of arrays</span>
<span class="sd">                (in case the model has multiple inputs).</span>
<span class="sd">            - A dict mapping input names to the corresponding arrays,</span>
<span class="sd">                if the model has named inputs.</span>
<span class="sd">            - A generator returning `(inputs,)`, `(inputs, targets)`</span>
<span class="sd">                or `(inputs, targets, sample_weights)`.</span>

<span class="sd">            A more detailed description of</span>
<span class="sd">            unpacking behavior for iterator types generator</span>
<span class="sd">            is given in the `Unpacking behavior for iterator-like inputs` section</span>
<span class="sd">            of `Model.fit`.</span>
<span class="sd">        y: Target data. Like the input data `x`,</span>
<span class="sd">            it could be either Numpy or Jax array(s).</span>
<span class="sd">            It should be consistent with `x`. If `x` is a generator,</span>
<span class="sd">            `y` should not be specified (since targets will be obtained from `x`).</span>
<span class="sd">        verbose: 0, 1, or 2. Verbosity mode.</span>
<span class="sd">            0 = silent, 1 = progress bar, 2 = one line per epoch.</span>
<span class="sd">        batch_size: Integer or `None`.</span>
<span class="sd">            Number of samples per gradient update.</span>
<span class="sd">            If unspecified, `batch_size` will default to 32.</span>
<span class="sd">            Do not specify the `batch_size` if your data is in the</span>
<span class="sd">            form of generator (since they generate batches).</span>
<span class="sd">        sample_weight: Optional Numpy/Jax array of weights for</span>
<span class="sd">            the training samples, used for weighting the loss function</span>
<span class="sd">            (during training only). You can either pass a flat (1D)</span>
<span class="sd">            Numpy array with the same length as the input samples</span>
<span class="sd">            (1:1 mapping between weights and samples). This argument is not</span>
<span class="sd">            supported when `x` is generator, instead provide the sample_weights</span>
<span class="sd">            as the third element of `x`.</span>
<span class="sd">        steps: Integer or `None`. Total number of steps (batches of samples)</span>
<span class="sd">            before declaring the evaluation round finished. Ignored with the</span>
<span class="sd">            default value of `None`. This</span>
<span class="sd">            argument is not supported with array inputs.</span>
<span class="sd">        callbacks: List of [elegy.callbacks.callback.Callback][] instances.</span>
<span class="sd">            List of callbacks to apply during training.</span>

<span class="sd">    See the discussion of `Unpacking behavior for iterator-like inputs` for</span>
<span class="sd">    [`Model.fit`][elegy.model.model.Model.fit].</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary for mapping the losses and metrics names to the values obtained.</span>
<span class="sd">    Raises:</span>
<span class="sd">        ValueError: in case of invalid arguments.</span>
<span class="sd">    """</span>

    <span class="n">data_handler</span> <span class="o">=</span> <span class="n">DataHandler</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
        <span class="n">initial_epoch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Container that configures and calls `tf.keras.Callback`s.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callbacks</span><span class="p">,</span> <span class="n">CallbackList</span><span class="p">):</span>
        <span class="n">callbacks</span> <span class="o">=</span> <span class="n">CallbackList</span><span class="p">(</span>
            <span class="n">callbacks</span><span class="p">,</span>
            <span class="n">add_history</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">add_progbar</span><span class="o">=</span><span class="n">verbose</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">steps</span><span class="o">=</span><span class="n">data_handler</span><span class="o">.</span><span class="n">inferred_steps</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">callbacks</span><span class="o">.</span><span class="n">on_test_begin</span><span class="p">()</span>

    <span class="n">logs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">iterator</span> <span class="ow">in</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">enumerate_epochs</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_metrics</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">catch_stop_iteration</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">steps</span><span class="p">():</span>
                <span class="n">callbacks</span><span class="o">.</span><span class="n">on_test_batch_begin</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
                <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
                <span class="n">x_batch</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">,</span> <span class="n">sample_weight</span> <span class="o">=</span> <span class="n">unpack_x_y_sample_weight</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

                <span class="n">tmp_logs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_on_batch</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x_batch</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y_batch</span><span class="p">,</span>
                    <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">tmp_logs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">"size"</span><span class="p">:</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">batch_size</span><span class="p">})</span>
                <span class="n">logs</span> <span class="o">=</span> <span class="n">tmp_logs</span>
                <span class="n">callbacks</span><span class="o">.</span><span class="n">on_test_batch_end</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">logs</span><span class="p">)</span>

    <span class="n">callbacks</span><span class="o">.</span><span class="n">on_test_end</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">logs</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h2 class="doc doc-heading" id="elegy.model.model_base.ModelBase.fit">

<code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_epoch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">steps_per_epoch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validation_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validation_batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validation_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


      </h2>
<div class="doc doc-contents ">
<p>Trains the model for a fixed number of epochs (iterations on a dataset).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td><code>Union[numpy.ndarray, Mapping[str, numpy.ndarray], Tuple[numpy.ndarray], Iterable]</code></td>
<td>
<p>Input data. It could be:</p>
<ul>
<li>A Numpy or Jax array (or array-like), or a list of arrays
    (in case the model has multiple inputs).</li>
<li>A dict mapping input names to the corresponding arrays,
    if the model has named inputs.</li>
<li>A generator returning <code>(inputs,)</code>, <code>(inputs, targets)</code>
    or <code>(inputs, targets, sample_weights)</code>.</li>
</ul>
<p>A more detailed description of unpacking behavior for generator type
is given below.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>Union[numpy.ndarray, Mapping[str, numpy.ndarray], Tuple[numpy.ndarray]]</code></td>
<td>
<p>Target data. Like the input data <code>x</code>,
it could be either Numpy or Jax array(s).
It should be consistent with <code>x</code>. If <code>x</code> is a generator,
<code>y</code> should not be specified (since targets will be obtained from <code>x</code>).</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td><code>Optional[int]</code></td>
<td>
<p>Integer or <code>None</code>.
Number of samples per gradient update.
If unspecified, <code>batch_size</code> will default to 32.
Do not specify the <code>batch_size</code> if your data is in the
form of generator (since they generate batches).</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>epochs</code></td>
<td><code>int</code></td>
<td>
<p>Integer. Number of epochs to train the model.
An epoch is an iteration over the entire <code>x</code> and <code>y</code>
data provided.
Note that in conjunction with <code>initial_epoch</code>,
<code>epochs</code> is to be understood as "final epoch".
The model is not trained for a number of iterations
given by <code>epochs</code>, but merely until the epoch
of index <code>epochs</code> is reached.</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td>
<p>0, 1, 2 or 3. Verbosity mode.
0 = silent, 1 = progress bar, 2 = one line per epoch 3 = table.
Note that the progress bar is not particularly useful when
logged to a file, so verbose=2 is recommended when not running
interactively (eg, in a production environment).</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Union[List[elegy.callbacks.callback.Callback], elegy.callbacks.callback_list.CallbackList]</code></td>
<td>
<p>List of <a href="../callbacks/Callback/#elegy.callbacks.callback.Callback">elegy.callbacks.callback.Callback</a> instances.
List of callbacks to apply during training.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>validation_split</code></td>
<td><code>float</code></td>
<td>
<p>Float between 0 and 1.
Fraction of the training data to be used as validation data.
The model will set apart this fraction of the training data,
will not train on it, and will evaluate
the loss and any model metrics
on this data at the end of each epoch.
The validation data is selected from the last samples
in the <code>x</code> and <code>y</code> data provided, before shuffling. This argument is
not supported when <code>x</code> is a generator.</p>
</td>
<td><code>0.0</code></td>
</tr>
<tr>
<td><code>validation_data</code></td>
<td><code>Union[Tuple, Iterable]</code></td>
<td>
<p>Data on which to evaluate
the loss and any model metrics at the end of each epoch.
The model will not be trained on this data.
<code>validation_data</code> will override <code>validation_split</code>.
<code>validation_data</code> could be:</p>
<ul>
<li>tuple <code>(x_val, y_val)</code> of Numpy/Jax arrays, list of arrays or mappings</li>
<li>tuple <code>(x_val, y_val, val_sample_weights)</code> of Numpy/Jax arrays, list
of arrays or mappings</li>
<li>generator</li>
</ul>
<p>For the first two cases, <code>batch_size</code> must be provided.
For the last case, <code>validation_steps</code> should be provided, and should
follow the same convention for yielding data as <code>x</code>.
Note that <code>validation_data</code> does not support all the data types that
are supported in <code>x</code>, eg, dict.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>shuffle</code></td>
<td><code>bool</code></td>
<td>
<p>Boolean (whether to shuffle the training data
before each epoch). This argument is ignored
when <code>x</code> is a generator. Has no effect when <code>steps_per_epoch</code> is not <code>None</code>.</p>
</td>
<td><code>True</code></td>
</tr>
<tr>
<td><code>class_weight</code></td>
<td><code>Optional[Mapping[str, float]]</code></td>
<td>
<p>Optional dictionary mapping class indices (integers)
to a weight (float) value, used for weighting the loss function
(during training only).
This can be useful to tell the model to
"pay more attention" to samples from
an under-represented class.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>sample_weight</code></td>
<td><code>Optional[numpy.ndarray]</code></td>
<td>
<p>Optional Numpy/Jax array of weights for
the training samples, used for weighting the loss function
(during training only). You can either pass a flat (1D)
Numpy array with the same length as the input samples
(1:1 mapping between weights and samples). This argument is not
supported when <code>x</code> is generator, instead provide the sample_weights
as the third element of <code>x</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>initial_epoch</code></td>
<td><code>int</code></td>
<td>
<p>Integer.
Epoch at which to start training
(useful for resuming a previous training run).</p>
</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>steps_per_epoch</code></td>
<td><code>Optional[int]</code></td>
<td>
<p>Integer or <code>None</code>.
Total number of steps (batches of samples)
before declaring one epoch finished and starting the
next epoch. When training with input arrays such as
jax data arrays, the default <code>None</code> is equal to
the number of samples in your dataset divided by
the batch size, or 1 if that cannot be determined.
When passing a generator, you must specify the
<code>steps_per_epoch</code> argument. This argument is not supported with
array inputs.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>validation_steps</code></td>
<td><code>Optional[int]</code></td>
<td>
<p>Only relevant if <code>validation_data</code> is provided and
is a generator. Total number of steps (batches of
samples) to draw before stopping when performing validation
at the end of every epoch. If 'validation_steps' is None, validation
will run until the <code>validation_data</code> dataset is exhausted. In the
case of an infinitely repeated dataset, it will run into an
infinite loop. If 'validation_steps' is specified and only part of
the dataset will be consumed, the evaluation will start from the
beginning of the dataset at each epoch. This ensures that the same
validation samples are used every time.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>validation_batch_size</code></td>
<td><code>Optional[int]</code></td>
<td>
<p>Integer or <code>None</code>.
Number of samples per validation batch.
If unspecified, will default to <code>batch_size</code>.
Do not specify the <code>validation_batch_size</code> if your data is in the
form of generators (since they generate batches).</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>validation_freq</code></td>
<td><code>int</code></td>
<td>
<p>Only relevant if validation data is provided. Integer
or <code>collections_abc.Container</code> instance (e.g. list, tuple, etc.).
If an integer, specifies how many training epochs to run before a
new validation run is performed, e.g. <code>validation_freq=2</code> runs
validation every 2 epochs. If a Container, specifies the epochs on
which to run validation, e.g. <code>validation_freq=[1, 2, 10]</code> runs
validation at the end of the 1st, 2nd, and 10th epochs.</p>
</td>
<td><code>1</code></td>
</tr>
</tbody>
</table>
<p>Unpacking behavior for iterator-like inputs:</p>
<p>A common pattern is to pass a generator, which will in fact
yield not only features (x) but optionally targets (y) and sample weights.
Elegy requires that the output of such iterator-likes be unambiguous. The
iterator should return a tuple of length 1, 2, or 3, where the optional
second and third elements will be used for y and sample_weight
respectively. Any other type provided will be wrapped in a length one
tuple, effectively treating everything as 'x'. When yielding dicts, they
should still adhere to the top-level tuple structure.
e.g. <code>({"x0": x0, "x1": x1}, y)</code>. Elegy will not attempt to separate
features, targets, and weights from the keys of a single dict.</p>
<p>A notable unsupported data type is the namedtuple. The reason is that
it behaves like both an ordered datatype (tuple) and a mapping
datatype (dict). So given a namedtuple of the form:
    <code>namedtuple("example_tuple", ["y", "x"])</code>
it is ambiguous whether to reverse the order of the elements when
interpreting the value. Even worse is a tuple of the form:
    <code>namedtuple("other_tuple", ["x", "y", "z"])</code>
where it is unclear if the tuple was intended to be unpacked into x, y,
and sample_weight or passed through as a single element to <code>x</code>. As a
result the data processing code will simply raise a ValueError if it
encounters a namedtuple. (Along with instructions to remedy the issue.)</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>History</code></td>
<td>
<p>A <code>History</code> object. Its <code>History.history</code> attribute is
a record of training loss values and metrics values
at successive epochs, as well as validation loss values
and validation metrics values (if applicable).</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>In case of mismatch between the provided input data
and what the model expects.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>elegy/model/model_base.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Iterable</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="kc">None</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">tp</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Callback</span><span class="p">],</span> <span class="n">CallbackList</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validation_split</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">validation_data</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Iterable</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">class_weight</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">initial_epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">steps_per_epoch</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validation_steps</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validation_batch_size</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validation_freq</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">History</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Trains the model for a fixed number of epochs (iterations on a dataset).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        x: Input data. It could be:</span>

<span class="sd">            - A Numpy or Jax array (or array-like), or a list of arrays</span>
<span class="sd">                (in case the model has multiple inputs).</span>
<span class="sd">            - A dict mapping input names to the corresponding arrays,</span>
<span class="sd">                if the model has named inputs.</span>
<span class="sd">            - A generator returning `(inputs,)`, `(inputs, targets)`</span>
<span class="sd">                or `(inputs, targets, sample_weights)`.</span>

<span class="sd">            A more detailed description of unpacking behavior for generator type</span>
<span class="sd">            is given below.</span>
<span class="sd">        y: Target data. Like the input data `x`,</span>
<span class="sd">            it could be either Numpy or Jax array(s).</span>
<span class="sd">            It should be consistent with `x`. If `x` is a generator,</span>
<span class="sd">            `y` should not be specified (since targets will be obtained from `x`).</span>
<span class="sd">        batch_size: Integer or `None`.</span>
<span class="sd">            Number of samples per gradient update.</span>
<span class="sd">            If unspecified, `batch_size` will default to 32.</span>
<span class="sd">            Do not specify the `batch_size` if your data is in the</span>
<span class="sd">            form of generator (since they generate batches).</span>
<span class="sd">        epochs: Integer. Number of epochs to train the model.</span>
<span class="sd">            An epoch is an iteration over the entire `x` and `y`</span>
<span class="sd">            data provided.</span>
<span class="sd">            Note that in conjunction with `initial_epoch`,</span>
<span class="sd">            `epochs` is to be understood as "final epoch".</span>
<span class="sd">            The model is not trained for a number of iterations</span>
<span class="sd">            given by `epochs`, but merely until the epoch</span>
<span class="sd">            of index `epochs` is reached.</span>
<span class="sd">        verbose: 0, 1, 2 or 3. Verbosity mode.</span>
<span class="sd">            0 = silent, 1 = progress bar, 2 = one line per epoch 3 = table.</span>
<span class="sd">            Note that the progress bar is not particularly useful when</span>
<span class="sd">            logged to a file, so verbose=2 is recommended when not running</span>
<span class="sd">            interactively (eg, in a production environment).</span>
<span class="sd">        callbacks: List of [elegy.callbacks.callback.Callback][] instances.</span>
<span class="sd">            List of callbacks to apply during training.</span>
<span class="sd">        validation_split: Float between 0 and 1.</span>
<span class="sd">            Fraction of the training data to be used as validation data.</span>
<span class="sd">            The model will set apart this fraction of the training data,</span>
<span class="sd">            will not train on it, and will evaluate</span>
<span class="sd">            the loss and any model metrics</span>
<span class="sd">            on this data at the end of each epoch.</span>
<span class="sd">            The validation data is selected from the last samples</span>
<span class="sd">            in the `x` and `y` data provided, before shuffling. This argument is</span>
<span class="sd">            not supported when `x` is a generator.</span>
<span class="sd">        validation_data: Data on which to evaluate</span>
<span class="sd">            the loss and any model metrics at the end of each epoch.</span>
<span class="sd">            The model will not be trained on this data.</span>
<span class="sd">            `validation_data` will override `validation_split`.</span>
<span class="sd">            `validation_data` could be:</span>

<span class="sd">            - tuple `(x_val, y_val)` of Numpy/Jax arrays, list of arrays or mappings</span>
<span class="sd">            - tuple `(x_val, y_val, val_sample_weights)` of Numpy/Jax arrays, list</span>
<span class="sd">            of arrays or mappings</span>
<span class="sd">            - generator</span>

<span class="sd">            For the first two cases, `batch_size` must be provided.</span>
<span class="sd">            For the last case, `validation_steps` should be provided, and should</span>
<span class="sd">            follow the same convention for yielding data as `x`.</span>
<span class="sd">            Note that `validation_data` does not support all the data types that</span>
<span class="sd">            are supported in `x`, eg, dict.</span>
<span class="sd">        shuffle: Boolean (whether to shuffle the training data</span>
<span class="sd">            before each epoch). This argument is ignored</span>
<span class="sd">            when `x` is a generator. Has no effect when `steps_per_epoch` is not `None`.</span>
<span class="sd">        class_weight: Optional dictionary mapping class indices (integers)</span>
<span class="sd">            to a weight (float) value, used for weighting the loss function</span>
<span class="sd">            (during training only).</span>
<span class="sd">            This can be useful to tell the model to</span>
<span class="sd">            "pay more attention" to samples from</span>
<span class="sd">            an under-represented class.</span>
<span class="sd">        sample_weight: Optional Numpy/Jax array of weights for</span>
<span class="sd">            the training samples, used for weighting the loss function</span>
<span class="sd">            (during training only). You can either pass a flat (1D)</span>
<span class="sd">            Numpy array with the same length as the input samples</span>
<span class="sd">            (1:1 mapping between weights and samples). This argument is not</span>
<span class="sd">            supported when `x` is generator, instead provide the sample_weights</span>
<span class="sd">            as the third element of `x`.</span>
<span class="sd">        initial_epoch: Integer.</span>
<span class="sd">            Epoch at which to start training</span>
<span class="sd">            (useful for resuming a previous training run).</span>
<span class="sd">        steps_per_epoch: Integer or `None`.</span>
<span class="sd">            Total number of steps (batches of samples)</span>
<span class="sd">            before declaring one epoch finished and starting the</span>
<span class="sd">            next epoch. When training with input arrays such as</span>
<span class="sd">            jax data arrays, the default `None` is equal to</span>
<span class="sd">            the number of samples in your dataset divided by</span>
<span class="sd">            the batch size, or 1 if that cannot be determined.</span>
<span class="sd">            When passing a generator, you must specify the</span>
<span class="sd">            `steps_per_epoch` argument. This argument is not supported with</span>
<span class="sd">            array inputs.</span>
<span class="sd">        validation_steps: Only relevant if `validation_data` is provided and</span>
<span class="sd">            is a generator. Total number of steps (batches of</span>
<span class="sd">            samples) to draw before stopping when performing validation</span>
<span class="sd">            at the end of every epoch. If 'validation_steps' is None, validation</span>
<span class="sd">            will run until the `validation_data` dataset is exhausted. In the</span>
<span class="sd">            case of an infinitely repeated dataset, it will run into an</span>
<span class="sd">            infinite loop. If 'validation_steps' is specified and only part of</span>
<span class="sd">            the dataset will be consumed, the evaluation will start from the</span>
<span class="sd">            beginning of the dataset at each epoch. This ensures that the same</span>
<span class="sd">            validation samples are used every time.</span>
<span class="sd">        validation_batch_size: Integer or `None`.</span>
<span class="sd">            Number of samples per validation batch.</span>
<span class="sd">            If unspecified, will default to `batch_size`.</span>
<span class="sd">            Do not specify the `validation_batch_size` if your data is in the</span>
<span class="sd">            form of generators (since they generate batches).</span>
<span class="sd">        validation_freq: Only relevant if validation data is provided. Integer</span>
<span class="sd">            or `collections_abc.Container` instance (e.g. list, tuple, etc.).</span>
<span class="sd">            If an integer, specifies how many training epochs to run before a</span>
<span class="sd">            new validation run is performed, e.g. `validation_freq=2` runs</span>
<span class="sd">            validation every 2 epochs. If a Container, specifies the epochs on</span>
<span class="sd">            which to run validation, e.g. `validation_freq=[1, 2, 10]` runs</span>
<span class="sd">            validation at the end of the 1st, 2nd, and 10th epochs.</span>

<span class="sd">    Unpacking behavior for iterator-like inputs:</span>

<span class="sd">    A common pattern is to pass a generator, which will in fact</span>
<span class="sd">    yield not only features (x) but optionally targets (y) and sample weights.</span>
<span class="sd">    Elegy requires that the output of such iterator-likes be unambiguous. The</span>
<span class="sd">    iterator should return a tuple of length 1, 2, or 3, where the optional</span>
<span class="sd">    second and third elements will be used for y and sample_weight</span>
<span class="sd">    respectively. Any other type provided will be wrapped in a length one</span>
<span class="sd">    tuple, effectively treating everything as 'x'. When yielding dicts, they</span>
<span class="sd">    should still adhere to the top-level tuple structure.</span>
<span class="sd">    e.g. `({"x0": x0, "x1": x1}, y)`. Elegy will not attempt to separate</span>
<span class="sd">    features, targets, and weights from the keys of a single dict.</span>

<span class="sd">    A notable unsupported data type is the namedtuple. The reason is that</span>
<span class="sd">    it behaves like both an ordered datatype (tuple) and a mapping</span>
<span class="sd">    datatype (dict). So given a namedtuple of the form:</span>
<span class="sd">        `namedtuple("example_tuple", ["y", "x"])`</span>
<span class="sd">    it is ambiguous whether to reverse the order of the elements when</span>
<span class="sd">    interpreting the value. Even worse is a tuple of the form:</span>
<span class="sd">        `namedtuple("other_tuple", ["x", "y", "z"])`</span>
<span class="sd">    where it is unclear if the tuple was intended to be unpacked into x, y,</span>
<span class="sd">    and sample_weight or passed through as a single element to `x`. As a</span>
<span class="sd">    result the data processing code will simply raise a ValueError if it</span>
<span class="sd">    encounters a namedtuple. (Along with instructions to remedy the issue.)</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `History` object. Its `History.history` attribute is</span>
<span class="sd">        a record of training loss values and metrics values</span>
<span class="sd">        at successive epochs, as well as validation loss values</span>
<span class="sd">        and validation metrics values (if applicable).</span>
<span class="sd">    Raises:</span>
<span class="sd">        ValueError: In case of mismatch between the provided input data</span>
<span class="sd">            and what the model expects.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">validation_split</span><span class="p">:</span>
        <span class="c1"># Create the validation data using the training data. Only supported for</span>
        <span class="c1"># `Jax Numpy` and `NumPy` input.</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">),</span> <span class="n">validation_data</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
            <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">),</span> <span class="n">validation_split</span><span class="o">=</span><span class="n">validation_split</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">stop_training</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">data_handler</span> <span class="o">=</span> <span class="n">DataHandler</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">steps_per_epoch</span><span class="p">,</span>
        <span class="n">initial_epoch</span><span class="o">=</span><span class="n">initial_epoch</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="n">shuffle</span><span class="p">,</span>
        <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weight</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Container that configures and calls `tf.keras.Callback`s.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callbacks</span><span class="p">,</span> <span class="n">CallbackList</span><span class="p">):</span>
        <span class="n">callbacks</span> <span class="o">=</span> <span class="n">CallbackList</span><span class="p">(</span>
            <span class="n">callbacks</span><span class="p">,</span>
            <span class="n">add_history</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">add_progbar</span><span class="o">=</span><span class="n">verbose</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
            <span class="n">steps</span><span class="o">=</span><span class="n">data_handler</span><span class="o">.</span><span class="n">inferred_steps</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">callbacks</span><span class="o">.</span><span class="n">on_train_begin</span><span class="p">()</span>
    <span class="c1"># data_handler._initial_epoch = (  # pylint: disable=protected-access</span>
    <span class="c1">#     self._maybe_load_initial_epoch_from_ckpt(initial_epoch))</span>

    <span class="k">for</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">iterator</span> <span class="ow">in</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">enumerate_epochs</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_metrics</span><span class="p">()</span>
        <span class="n">callbacks</span><span class="o">.</span><span class="n">on_epoch_begin</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span>
        <span class="n">logs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">with</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">catch_stop_iteration</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">steps</span><span class="p">():</span>
                <span class="n">callbacks</span><span class="o">.</span><span class="n">on_train_batch_begin</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
                <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
                <span class="c1"># sample_weight = batch[2] if len(batch) == 3 else None</span>
                <span class="n">x_batch</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">,</span> <span class="n">sample_weight</span> <span class="o">=</span> <span class="n">unpack_x_y_sample_weight</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

                <span class="n">tmp_logs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_on_batch</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x_batch</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y_batch</span><span class="p">,</span>
                    <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
                    <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weight</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">tmp_logs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">"size"</span><span class="p">:</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">batch_size</span><span class="p">})</span>
                <span class="c1"># print(epoch, step, tmp_logs["accuracy"], batch[0].shape)</span>

                <span class="n">logs</span> <span class="o">=</span> <span class="n">tmp_logs</span>
                <span class="n">callbacks</span><span class="o">.</span><span class="n">on_train_batch_end</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">logs</span><span class="p">)</span>

        <span class="n">epoch_logs</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">logs</span><span class="p">)</span>
        <span class="n">epoch_logs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">"size"</span><span class="p">:</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">batch_size</span><span class="p">})</span>

        <span class="c1"># Run validation.</span>
        <span class="k">if</span> <span class="n">validation_data</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_eval</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">validation_freq</span><span class="p">):</span>
            <span class="n">val_x</span><span class="p">,</span> <span class="n">val_y</span><span class="p">,</span> <span class="n">val_sample_weight</span> <span class="o">=</span> <span class="n">unpack_x_y_sample_weight</span><span class="p">(</span>
                <span class="n">validation_data</span>
            <span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val_logs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">val_x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">val_y</span><span class="p">,</span>
                    <span class="n">sample_weight</span><span class="o">=</span><span class="n">val_sample_weight</span><span class="p">,</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="n">validation_batch_size</span> <span class="ow">or</span> <span class="n">batch_size</span><span class="p">,</span>
                    <span class="n">steps</span><span class="o">=</span><span class="n">validation_steps</span><span class="p">,</span>
                    <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
                    <span class="c1"># return_dict=True,</span>
                <span class="p">)</span>

                <span class="n">val_logs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"val_"</span> <span class="o">+</span> <span class="n">name</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">val_logs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
                <span class="n">epoch_logs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">val_logs</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">types</span><span class="o">.</span><span class="n">MissingMethod</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MissingModule</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="n">callbacks</span><span class="o">.</span><span class="n">on_epoch_end</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">epoch_logs</span><span class="p">)</span>
        <span class="c1"># print(</span>
        <span class="c1">#     f"epoch: {epoch} - "</span>
        <span class="c1">#     + " - ".join(f"{key}: {value:.3f}" for key, value in epoch_logs.items())</span>
        <span class="c1"># )</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_training</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="n">callbacks</span><span class="o">.</span><span class="n">on_train_end</span><span class="p">()</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">history</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h2 class="doc doc-heading" id="elegy.model.model_base.ModelBase.load">

<code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

      </h2>
<div class="doc doc-contents ">
<p>Loads all weights + states from a folder structure.</p>
<p>You can load states from other models that have slightly different architecture
as long as long as it preserves the ordering of the <code>haiku.Params</code> + <code>haiku.State</code>
structures, adding or removing layers is fine as long as they don't have weights,
new layers with weights will be initialized from scratch.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td><code>Union[str, pathlib.Path]</code></td>
<td>
<p>path to a saved model's directory.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>elegy/model/model_base.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">load</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Loads all weights + states from a folder structure.</span>

<span class="sd">    You can load states from other models that have slightly different architecture</span>
<span class="sd">    as long as long as it preserves the ordering of the `haiku.Params` + `haiku.State`</span>
<span class="sd">    structures, adding or removing layers is fine as long as they don't have weights,</span>
<span class="sd">    new layers with weights will be initialized from scratch.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        path: path to a saved model's directory.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">loads</span><span class="p">((</span><span class="n">path</span> <span class="o">/</span> <span class="s2">"states.pkl"</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initial_states</span> <span class="o">=</span> <span class="n">cloudpickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
        <span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">"initial_states.pkl"</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h2 class="doc doc-heading" id="elegy.model.model_base.ModelBase.predict">

<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


      </h2>
<div class="doc doc-contents ">
<p>Generates output predictions for the input samples.
Computation is done in batches.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td><code>Union[numpy.ndarray, Mapping[str, numpy.ndarray], Tuple[numpy.ndarray], Iterable]</code></td>
<td>
<p>Input data. It could be:</p>
<ul>
<li>A Numpy or Jax array (or array-like), or a list of arrays
    (in case the model has multiple inputs).</li>
<li>A dict mapping input names to the corresponding arrays,
    if the model has named inputs.</li>
<li>A generator returning <code>(inputs,)</code>, <code>(inputs, targets)</code>
    or <code>(inputs, targets, sample_weights)</code>.</li>
</ul>
<p>A more detailed description of
unpacking behavior for iterator types generator
is given in the <code>Unpacking behavior for iterator-like inputs</code> section
of <code>Model.fit</code>.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td><code>Optional[int]</code></td>
<td>
<p>Integer or <code>None</code>.
Number of samples per batch.
If unspecified, <code>batch_size</code> will default to 32.
Do not specify the <code>batch_size</code> if your data is in the
form of generators (since they generate batches).</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td>
<p>Verbosity mode, 0 or 1.</p>
</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>steps</code></td>
<td><code>Optional[int]</code></td>
<td>
<p>Total number of steps (batches of samples)
before declaring the prediction round finished.
Ignored with the default value of <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>Union[List[elegy.callbacks.callback.Callback], elegy.callbacks.callback_list.CallbackList]</code></td>
<td>
<p>List of <a href="../callbacks/Callback/#elegy.callbacks.callback.Callback">elegy.callbacks.callback.Callback</a> instances.
List of callbacks to apply during training.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p>See the discussion of <code>Unpacking behavior for iterator-like inputs</code> for
<a href="../Model/#elegy.model.model.Model.fit"><code>Model.fit</code></a>.
Note that Model.predict uses the same interpretation rules as
<code>Model.fit</code> and <code>Model.evaluate</code>, so inputs must be unambiguous for all
three methods.</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Any</code></td>
<td>
<p>Numpy array(s) of predictions.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>In case of mismatch between the provided
input data and the model's expectations,
or in case a stateful model receives a number of samples
that is not a multiple of the batch size.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>elegy/model/model_base.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
        <span class="n">tp</span><span class="o">.</span><span class="n">Iterable</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">tp</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Callback</span><span class="p">],</span> <span class="n">CallbackList</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tp</span><span class="o">.</span><span class="n">Any</span><span class="p">:</span>
    <span class="sd">"""Generates output predictions for the input samples.</span>
<span class="sd">    Computation is done in batches.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        x: Input data. It could be:</span>

<span class="sd">            - A Numpy or Jax array (or array-like), or a list of arrays</span>
<span class="sd">                (in case the model has multiple inputs).</span>
<span class="sd">            - A dict mapping input names to the corresponding arrays,</span>
<span class="sd">                if the model has named inputs.</span>
<span class="sd">            - A generator returning `(inputs,)`, `(inputs, targets)`</span>
<span class="sd">                or `(inputs, targets, sample_weights)`.</span>

<span class="sd">            A more detailed description of</span>
<span class="sd">            unpacking behavior for iterator types generator</span>
<span class="sd">            is given in the `Unpacking behavior for iterator-like inputs` section</span>
<span class="sd">            of `Model.fit`.</span>
<span class="sd">        batch_size: Integer or `None`.</span>
<span class="sd">            Number of samples per batch.</span>
<span class="sd">            If unspecified, `batch_size` will default to 32.</span>
<span class="sd">            Do not specify the `batch_size` if your data is in the</span>
<span class="sd">            form of generators (since they generate batches).</span>
<span class="sd">        verbose: Verbosity mode, 0 or 1.</span>
<span class="sd">        steps: Total number of steps (batches of samples)</span>
<span class="sd">            before declaring the prediction round finished.</span>
<span class="sd">            Ignored with the default value of `None`.</span>
<span class="sd">        callbacks: List of [elegy.callbacks.callback.Callback][] instances.</span>
<span class="sd">            List of callbacks to apply during training.</span>

<span class="sd">    See the discussion of `Unpacking behavior for iterator-like inputs` for</span>
<span class="sd">    [`Model.fit`][elegy.model.model.Model.fit].</span>
<span class="sd">    Note that Model.predict uses the same interpretation rules as</span>
<span class="sd">    `Model.fit` and `Model.evaluate`, so inputs must be unambiguous for all</span>
<span class="sd">    three methods.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Numpy array(s) of predictions.</span>
<span class="sd">    Raises:</span>
<span class="sd">        ValueError: In case of mismatch between the provided</span>
<span class="sd">            input data and the model's expectations,</span>
<span class="sd">            or in case a stateful model receives a number of samples</span>
<span class="sd">            that is not a multiple of the batch size.</span>
<span class="sd">    """</span>

    <span class="n">outputs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">data_handler</span> <span class="o">=</span> <span class="n">DataHandler</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
        <span class="n">initial_epoch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Container that configures and calls `tf.keras.Callback`s.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">callbacks</span><span class="p">,</span> <span class="n">CallbackList</span><span class="p">):</span>
        <span class="n">callbacks</span> <span class="o">=</span> <span class="n">CallbackList</span><span class="p">(</span>
            <span class="n">callbacks</span><span class="p">,</span>
            <span class="n">add_history</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">add_progbar</span><span class="o">=</span><span class="n">verbose</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">steps</span><span class="o">=</span><span class="n">data_handler</span><span class="o">.</span><span class="n">inferred_steps</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">callbacks</span><span class="o">.</span><span class="n">on_predict_begin</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">iterator</span> <span class="ow">in</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">enumerate_epochs</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_metrics</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">catch_stop_iteration</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">steps</span><span class="p">():</span>
                <span class="n">callbacks</span><span class="o">.</span><span class="n">on_predict_batch_begin</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
                <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
                <span class="n">tmp_batch_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_on_batch</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">batch_outputs</span> <span class="o">=</span> <span class="n">tmp_batch_outputs</span>

                <span class="k">if</span> <span class="n">outputs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">outputs</span> <span class="o">=</span> <span class="n">map_structure</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">batch_output</span><span class="p">:</span> <span class="p">[</span><span class="n">batch_output</span><span class="p">],</span> <span class="n">batch_outputs</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>

                    <span class="n">outputs</span> <span class="o">=</span> <span class="n">map_structure</span><span class="p">(</span>
                        <span class="n">map_append</span><span class="p">,</span>
                        <span class="n">outputs</span><span class="p">,</span>
                        <span class="n">batch_outputs</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="n">callbacks</span><span class="o">.</span><span class="n">on_predict_batch_end</span><span class="p">(</span>
                    <span class="n">step</span><span class="p">,</span>
                    <span class="p">{</span><span class="s2">"outputs"</span><span class="p">:</span> <span class="n">batch_outputs</span><span class="p">,</span> <span class="s2">"size"</span><span class="p">:</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">batch_size</span><span class="p">},</span>
                <span class="p">)</span>

    <span class="n">callbacks</span><span class="o">.</span><span class="n">on_predict_end</span><span class="p">()</span>

    <span class="n">all_outputs</span> <span class="o">=</span> <span class="n">map_structure</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">all_outputs</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h2 class="doc doc-heading" id="elegy.model.model_base.ModelBase.predict_on_batch">

<code class="highlight language-python"><span class="n">predict_on_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

      </h2>
<div class="doc doc-contents ">
<p>Returns predictions for a single batch of samples.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td><code>Union[numpy.ndarray, Mapping[str, Any], Tuple]</code></td>
<td>
<p>Input data. A Numpy/Jax array (or array-like), or possibly
nested python structure of dict, list, tuple that contain
arrays as leafs.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Union[numpy.ndarray, Mapping[str, Any], Tuple]</code></td>
<td>
<p>Jax array(s) of predictions.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>In case of mismatch between given number of inputs and
expectations of the model.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>elegy/model/model_base.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">predict_on_batch</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">]:</span>
    <span class="sd">"""</span>
<span class="sd">    Returns predictions for a single batch of samples.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        x: Input data. A Numpy/Jax array (or array-like), or possibly</span>
<span class="sd">            nested python structure of dict, list, tuple that contain</span>
<span class="sd">            arrays as leafs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Jax array(s) of predictions.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: In case of mismatch between given number of inputs and</span>
<span class="sd">            expectations of the model.</span>
<span class="sd">    """</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">pred</span>
    <span class="n">initializing</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">maybe_initialize</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

    <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_pred_step</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_eagerly</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_pred_step_jit</span>

    <span class="n">y_pred</span><span class="p">,</span> <span class="n">state_updates</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="n">initializing</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">state_updates</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y_pred</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h2 class="doc doc-heading" id="elegy.model.model_base.ModelBase.save">

<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

      </h2>
<div class="doc doc-contents ">
<p>Saves the model to disk.</p>
<p>It creates a directory that includes:</p>
<ul>
<li><code>{path}/model.pkl</code>: The <code>Model</code> object instance serialized with <code>pickle</code>,
    this allows you to re-instantiate the model later.</li>
<li><code>{path}/states.pkl</code>: The <code>Model.states</code> serialized with <code>pickle</code>.</li>
<li><code>{path}/initial_states.pkl</code>: The <code>Model.initial_states</code> serialized with <code>pickle</code>.</li>
</ul>
<p>This allows you to save the entirety of the states of a model
in a directory structure which can be fully restored via
<code>Model.load</code> if the model is already instiated or <code>elegy.model.load</code>
to load the model instance from its pickled version.</p>
<div class="codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">elegy</span>

<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">'my_model'</span><span class="p">)</span>  <span class="c1"># creates folder at 'my_model'</span>
<span class="k">del</span> <span class="n">model</span>  <span class="c1"># deletes the existing model</span>

<span class="c1"># returns a model identical to the previous one</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">elegy</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'my_model'</span><span class="p">)</span>
</code></pre>
</div>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td><code>Union[str, pathlib.Path]</code></td>
<td>
<p>path where model structure will be saved.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>elegy/model/model_base.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Saves the model to disk.</span>

<span class="sd">    It creates a directory that includes:</span>

<span class="sd">    - `{path}/model.pkl`: The `Model` object instance serialized with `pickle`,</span>
<span class="sd">        this allows you to re-instantiate the model later.</span>
<span class="sd">    - `{path}/states.pkl`: The `Model.states` serialized with `pickle`.</span>
<span class="sd">    - `{path}/initial_states.pkl`: The `Model.initial_states` serialized with `pickle`.</span>

<span class="sd">    This allows you to save the entirety of the states of a model</span>
<span class="sd">    in a directory structure which can be fully restored via</span>
<span class="sd">    `Model.load` if the model is already instiated or `elegy.model.load`</span>
<span class="sd">    to load the model instance from its pickled version.</span>

<span class="sd">    ```python</span>
<span class="sd">    import elegy</span>

<span class="sd">    model.save('my_model')  # creates folder at 'my_model'</span>
<span class="sd">    del model  # deletes the existing model</span>

<span class="sd">    # returns a model identical to the previous one</span>
<span class="sd">    model = elegy.model.load('my_model')</span>
<span class="sd">    ```</span>
<span class="sd">    Arguments:</span>
<span class="sd">        path: path where model structure will be saved.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">"states.pkl"</span><span class="p">,</span> <span class="s2">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span> <span class="o">/</span> <span class="s2">"initial_states.pkl"</span><span class="p">,</span> <span class="s2">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_states</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="s2">"model.pkl"</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">"wb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cloudpickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Error occurred saving the model object at </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="se">\n</span><span class="s2">Continuing...."</span>
            <span class="p">)</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h2 class="doc doc-heading" id="elegy.model.model_base.ModelBase.test_on_batch">

<code class="highlight language-python"><span class="n">test_on_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

      </h2>
<div class="doc doc-contents ">
<p>Test the model on a single batch of samples.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td><code>Union[numpy.ndarray, Mapping[str, Any], Tuple]</code></td>
<td>
<p>Input data. It could be:</p>
<ul>
<li>A Numpy array (or array-like), or a list
    of arrays (in case the model has multiple inputs).</li>
<li>A dict mapping input names to the corresponding arrays, if
    the model has named inputs.</li>
</ul>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>Union[numpy.ndarray, Mapping[str, Any], Tuple]</code></td>
<td>
<p>Target data. Like the input data <code>x</code>, it could be either Numpy
array(s) or Jax array(s).</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>sample_weight</code></td>
<td><code>Optional[numpy.ndarray]</code></td>
<td>
<p>Optional array of the same length as x, containing
weights to apply to the model's loss for each sample. In the case of
temporal data, you can pass a 2D array with shape (samples,
sequence_length), to apply a different weight to every timestep of
every sample.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Dict[str, Union[numpy.ndarray, float]]</code></td>
<td>
<p>A <code>logs</code> dictionary of containing the main <code>loss</code> as well as all
other losses and metrics.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>In case of invalid user-provided arguments.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>elegy/model/model_base.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">test_on_batch</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">class_weight</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">types</span><span class="o">.</span><span class="n">Logs</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Test the model on a single batch of samples.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        x: Input data. It could be:</span>

<span class="sd">            - A Numpy array (or array-like), or a list</span>
<span class="sd">                of arrays (in case the model has multiple inputs).</span>
<span class="sd">            - A dict mapping input names to the corresponding arrays, if</span>
<span class="sd">                the model has named inputs.</span>
<span class="sd">        y: Target data. Like the input data `x`, it could be either Numpy</span>
<span class="sd">            array(s) or Jax array(s).</span>
<span class="sd">        sample_weight: Optional array of the same length as x, containing</span>
<span class="sd">            weights to apply to the model's loss for each sample. In the case of</span>
<span class="sd">            temporal data, you can pass a 2D array with shape (samples,</span>
<span class="sd">            sequence_length), to apply a different weight to every timestep of</span>
<span class="sd">            every sample.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `logs` dictionary of containing the main `loss` as well as all</span>
<span class="sd">        other losses and metrics.</span>
<span class="sd">    Raises:</span>
<span class="sd">        ValueError: In case of invalid user-provided arguments.</span>
<span class="sd">    """</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">test</span>
    <span class="n">initializing</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">maybe_initialize</span><span class="p">(</span>
        <span class="n">mode</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y_true</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
        <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weight</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_test_step</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_eagerly</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_test_step_jit</span>

    <span class="n">loss</span><span class="p">,</span> <span class="n">logs</span><span class="p">,</span> <span class="n">state_updates</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">,</span>
        <span class="n">sample_weight</span><span class="p">,</span>
        <span class="n">class_weight</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">,</span>
        <span class="n">initializing</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">state_updates</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">logs</span>
</code></pre>
</div>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h2 class="doc doc-heading" id="elegy.model.model_base.ModelBase.train_on_batch">

<code class="highlight language-python"><span class="n">train_on_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-inherited"><code>inherited</code></small>
  </span>

      </h2>
<div class="doc doc-contents ">
<p>Runs a single gradient update on a single batch of data.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td><code>Union[numpy.ndarray, Mapping[str, Any], Tuple]</code></td>
<td>
<p>Input data. It could be:</p>
<ul>
<li>A Numpy array (or array-like), or a iterable of arrays
    (in case the model has multiple inputs).</li>
<li>A dict mapping input names to the corresponding arrays,
    if the model has named inputs.</li>
</ul>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>Union[numpy.ndarray, Mapping[str, Any], Tuple]</code></td>
<td>
<p>Target data. Like the input data <code>x</code>, it could be either Numpy
array(s) or Jax array(s). It should be consistent with <code>x</code>
(you cannot have Numpy inputs and array targets, or inversely).</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>sample_weight</code></td>
<td><code>Optional[numpy.ndarray]</code></td>
<td>
<p>Optional array of the same length as x, containing
weights to apply to the model's loss for each sample. In the case of
temporal data, you can pass a 2D array with shape (samples,
sequence_length), to apply a different weight to every timestep of
every sample.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>class_weight</code></td>
<td><code>Optional[numpy.ndarray]</code></td>
<td>
<p>Optional dictionary mapping class indices (integers) to a
weight (float) to apply to the model's loss for the samples from this
class during training. This can be useful to tell the model to "pay
more attention" to samples from an under-represented class.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Dict[str, Union[numpy.ndarray, float]]</code></td>
<td>
<p>A <code>logs</code> dictionary of containing the main <code>loss</code> as well as all
other losses and metrics.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>In case of invalid user-provided arguments.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>elegy/model/model_base.py</code></summary>
          <div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">train_on_batch</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">],</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">tp</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span> <span class="n">tp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sample_weight</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">class_weight</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">types</span><span class="o">.</span><span class="n">Logs</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Runs a single gradient update on a single batch of data.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        x: Input data. It could be:</span>

<span class="sd">            - A Numpy array (or array-like), or a iterable of arrays</span>
<span class="sd">                (in case the model has multiple inputs).</span>
<span class="sd">            - A dict mapping input names to the corresponding arrays,</span>
<span class="sd">                if the model has named inputs.</span>
<span class="sd">        y: Target data. Like the input data `x`, it could be either Numpy</span>
<span class="sd">            array(s) or Jax array(s). It should be consistent with `x`</span>
<span class="sd">            (you cannot have Numpy inputs and array targets, or inversely).</span>
<span class="sd">        sample_weight: Optional array of the same length as x, containing</span>
<span class="sd">            weights to apply to the model's loss for each sample. In the case of</span>
<span class="sd">            temporal data, you can pass a 2D array with shape (samples,</span>
<span class="sd">            sequence_length), to apply a different weight to every timestep of</span>
<span class="sd">            every sample.</span>
<span class="sd">        class_weight: Optional dictionary mapping class indices (integers) to a</span>
<span class="sd">            weight (float) to apply to the model's loss for the samples from this</span>
<span class="sd">            class during training. This can be useful to tell the model to "pay</span>
<span class="sd">            more attention" to samples from an under-represented class.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A `logs` dictionary of containing the main `loss` as well as all</span>
<span class="sd">        other losses and metrics.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: In case of invalid user-provided arguments.</span>
<span class="sd">    """</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">Mode</span><span class="o">.</span><span class="n">train</span>
    <span class="n">initializing</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">maybe_initialize</span><span class="p">(</span>
        <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y_true</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
        <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weight</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_train_step</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_eagerly</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_train_step_jit</span>

    <span class="n">logs</span><span class="p">,</span> <span class="n">state_updates</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="p">,</span>
        <span class="n">mode</span><span class="p">,</span>
        <span class="n">sample_weight</span><span class="p">,</span>
        <span class="n">class_weight</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">,</span>
        <span class="n">initializing</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">state_updates</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">logs</span>
</code></pre>
</div>
</details>
</div>
</div>
</div>
</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../Model/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Model
              </div>
            </div>
          </a>
        
        
          <a href="../Module/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Module
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/cgarciae" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://github.com/charlielito" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/cgarciae88" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/cgarciae" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/calvarez92" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.53cc9318.min.js"></script>
      <script src="../../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>